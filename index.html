<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FormCheck</title>
    
    <!-- AI Analysis Libraries -->
    <script src="https://cdn.jsdelivr.net/npm/@mediapipe/pose/pose.js" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/@mediapipe/camera_utils/camera_utils.js" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/@mediapipe/drawing_utils/drawing_utils.js" crossorigin="anonymous"></script>

    <style>
        :root {
            --primary-blue: #4089ff; 
            --primary-blue-hover: #3376e0;
            --active-green: #00e676;
            --trim-orange: #ff9100;
            --dark-background: #1e1e1e;
            --medium-dark-background: #2b2b2b;
            --light-card-background: #3a3a3a;
            --text-color-light: #f0f0f0;
            --text-color-medium: #b0b0b0;
            --border-color: #4a4a4a;
            --shadow-color: rgba(0, 0, 0, 0.4);
        }

        /* 2. Unified Font to Arial */
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 8px;
            background-color: var(--dark-background);
            color: var(--text-color-light);
            line-height: 1.4;
            font-size: 14px;
        }

        /* Ensure controls inherit the font */
        button, input, select, textarea {
            font-family: inherit;
        }

        .container {
            max-width: 600px;
            margin: 0 auto;
            background-color: var(--medium-dark-background);
            padding: 10px;
            border-radius: 12px;
            box-shadow: 0 1px 3px var(--shadow-color);
        }

        h1 {
            text-align: center;
            color: var(--primary-blue);
            margin: 5px 0 15px 0;
            font-size: 2.1em;
            font-weight: 800;
            letter-spacing: 0.05em;
        }

        /* File Upload Inputs - Compact */
        .upload-section {
            background: var(--light-card-background);
            padding: 8px;
            border-radius: 8px;
            margin-bottom: 8px;
            display: flex;
            gap: 5px;
        }
        .file-input-wrapper {
            flex: 1;
            position: relative;
            overflow: hidden;
            background-color: #444;
            border-radius: 6px;
            height: 30px;
            border: 1px solid var(--border-color);
        }
        .file-input-wrapper input[type="file"] { 
            position: absolute; 
            font-size: 100px; 
            opacity: 0; 
            right: 0; 
            top: 0; 
            cursor: pointer;
        }
        .file-input-wrapper span {
            display: flex;
            align-items: center;
            justify-content: center;
            height: 100%;
            font-size: 0.85em;
            color: #ccc;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            padding: 0 5px;
        }

        /* Canvas */
        .video-output {
            margin-bottom: 8px;
            text-align: center;
            position: relative;
        }
        canvas {
            display: block;
            margin: 0 auto;
            background-color: #000;
            max-width: 100%;
            border-radius: 6px;
            touch-action: auto; 
            border: 2px solid var(--border-color);
        }

        #aiLoader {
            position: absolute;
            top: 50%; left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(0,0,0,0.7);
            color: white;
            padding: 10px 20px;
            border-radius: 20px;
            font-weight: bold;
            display: none;
            pointer-events: none;
        }

        /* Controls Structure */
        .control-group {
            background-color: var(--light-card-background);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            padding: 10px;
            margin-bottom: 8px;
        }

        .tools-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 8px;
        }
        .tools-header h3 {
            margin: 0;
            font-size: 1em;
            color: var(--text-color-light);
        }
        .tool-buttons {
            display: flex;
            gap: 6px;
        }

        .video-row-header {
            display: flex;
            align-items: center;
            gap: 6px;
            margin-bottom: 5px;
        }
        .video-label {
            font-weight: 600;
            font-size: 1em;
            color: var(--text-color-light);
            margin-right: auto; 
            min-width: 60px;
        }
        .time-display {
            /* Removed monospace to unify font */
            color: var(--primary-blue);
            font-weight: bold;
            margin-left: auto;
            font-size: 0.9em;
        }

        /* Buttons */
        .icon-btn {
            width: 36px;
            height: 36px;
            padding: 0;
            background-color: var(--primary-blue);
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 1.2em;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
            color: white;
            transition: background 0.2s;
        }
        
        .icon-btn.flat-icon {
            color: transparent;
            text-shadow: 0 0 0 white;
        }

        .icon-btn:hover { background-color: var(--primary-blue-hover); }
        .icon-btn:active { transform: translateY(1px); }
        .icon-btn.active { background-color: var(--active-green); box-shadow: 0 0 4px var(--active-green); }
        .icon-btn.loading { background-color: #ffea00; cursor: wait; }

        .trim-btn {
            background-color: #555;
            font-weight: bold;
            font-size: 1.1em;
            /* Removed monospace to unify font */
        }

        /* Sliders */
        input[type="range"] {
            display: block;
            width: 100%;
            height: 12px;
            cursor: pointer;
            -webkit-appearance: none;
            background: transparent;
            margin-top: 5px;
        }
        input[type="range"]::-webkit-slider-runnable-track {
            height: 12px;
            border-radius: 6px;
        }
        input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            height: 20px;
            width: 20px;
            border-radius: 50%;
            background: white; 
            border: 2px solid var(--primary-blue);
            margin-top: -4px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.5);
        }

        /* Global Controls */
        .global-controls {
            display: flex;
            gap: 10px;
            margin-top: 10px;
        }
        .global-btn {
            flex: 1;
            height: 60px;
            border-radius: 10px;
            border: none;
            background-color: var(--primary-blue);
            color: white;
            font-size: 1.8em;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            box-shadow: 0 2px 5px rgba(0,0,0,0.3);
        }
        .global-btn:active { background-color: var(--primary-blue-hover); transform: translateY(2px); }

        .annotation-toolbar {
            display: none; 
            justify-content: center;
            gap: 10px;
            margin-top: 5px;
            padding-top: 5px;
            border-top: 1px solid #555;
        }
        .color-dot {
            width: 24px; height: 24px; border-radius: 50%; border: 2px solid #555; cursor: pointer;
        }
        .color-dot.selected { border-color: white; transform: scale(1.2); }

        .sr-only { display: none; }
    </style>
</head>
<body>
    <div class="container">
        <h1>FormCheck</h1>

        <div class="upload-section">
            <div class="file-input-wrapper">
                <input type="file" id="fileInput1" accept="video/*">
                <span id="fileName1">Upload Video 1...</span>
            </div>
            <div class="file-input-wrapper">
                <input type="file" id="fileInput2" accept="video/*">
                <span id="fileName2">Upload Video 2...</span>
            </div>
        </div>

        <div class="video-output">
            <canvas id="videoCanvas" width="640" height="360"></canvas>
            <div id="aiLoader">Initializing AI...</div>
        </div>

        <!-- Tool & Opacity Card -->
        <div class="control-group">
            <div class="tools-header">
                <h3>Overlay Opacity</h3>
                <div class="tool-buttons">
                    <button id="drawBtn" class="icon-btn" aria-label="Draw">‚úèÔ∏è</button>
                    <button id="textBtn" class="icon-btn" aria-label="Text">T</button>
                    <button id="undoBtn" class="icon-btn" aria-label="Undo">‚Ü©</button>
                </div>
            </div>
            <!-- Color Palette -->
            <div id="annotationToolbar" class="annotation-toolbar">
                <div class="color-dot selected" style="background: #ff3b30;" data-color="#ff3b30"></div>
                <div class="color-dot" style="background: #4cd964;" data-color="#4cd964"></div>
                <div class="color-dot" style="background: #007aff;" data-color="#007aff"></div>
                <div class="color-dot" style="background: #ffcc00;" data-color="#ffcc00"></div>
                <div class="color-dot" style="background: #ffffff;" data-color="#ffffff"></div>
            </div>
            
            <input type="range" id="opacitySlider" min="0" max="1" step="0.01" value="0.5" style="background: linear-gradient(to right, #555, #555);">
            <!-- 1. Removed the blue opacityCircle that was here -->
        </div>

        <!-- Video 1 Controls -->
        <div class="control-group">
            <div class="video-row-header">
                <span class="video-label">Video 1</span>
                <button id="moveV1Btn" class="icon-btn flat-icon" aria-label="Move">‚ú•</button>
                <button id="playPauseButton1" class="icon-btn flat-icon" aria-label="Play">‚ñ∂</button>
                <button id="restartButton1" class="icon-btn flat-icon" aria-label="Restart">‚Ü∫</button>
                <button id="boneBtn1" class="icon-btn bone-btn" aria-label="Bone">ü¶¥</button>
                <button id="setStart1" class="icon-btn trim-btn" aria-label="Start Trim">[</button>
                <button id="setEnd1" class="icon-btn trim-btn" aria-label="End Trim">]</button>
                <span id="timeValue1" class="time-display">0.00s</span>
            </div>
            <input type="range" id="timeSlider1" min="0" max="1" step="0.01" value="0" style="background: #444;">
        </div>

        <!-- Video 2 Controls -->
        <div class="control-group">
            <div class="video-row-header">
                <span class="video-label">Video 2</span>
                <button id="moveV2Btn" class="icon-btn flat-icon" aria-label="Move">‚ú•</button>
                <button id="playPauseButton2" class="icon-btn flat-icon" aria-label="Play">‚ñ∂</button>
                <button id="restartButton2" class="icon-btn flat-icon" aria-label="Restart">‚Ü∫</button>
                <button id="boneBtn2" class="icon-btn bone-btn" aria-label="Bone">ü¶¥</button>
                <button id="setStart2" class="icon-btn trim-btn" aria-label="Start Trim">[</button>
                <button id="setEnd2" class="icon-btn trim-btn" aria-label="End Trim">]</button>
                <span id="timeValue2" class="time-display">0.00s</span>
            </div>
            <input type="range" id="timeSlider2" min="0" max="1" step="0.01" value="0" style="background: #444;">
        </div>

        <!-- Global Bottom Controls -->
        <div class="global-controls">
            <button id="syncAllStartsButton" class="global-btn flat-icon">‚èÆ</button>
            <button id="pauseAllButton" class="global-btn flat-icon">‚è∏</button>
            <button id="playAllButton" class="global-btn flat-icon">‚ñ∂‚ñ∂</button>
        </div>
        
        <p id="status"></p>
    </div>

    <!-- Hidden video elements -->
    <video id="video1" preload="auto" crossorigin="anonymous" playsinline webkit-playsinline></video>
    <video id="video2" preload="auto" crossorigin="anonymous" playsinline webkit-playsinline></video>

    <script src="app.js"></script>
</body>
</html>